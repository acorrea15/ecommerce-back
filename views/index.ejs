<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ecommerce-5i Reseteo de contraseña</title>
    <script>
      var status = '<%- JSON.stringify(status) %>';

      if (JSON.parse(status) == "verified") {
        /* if (confirm("¿Desea iniciar sesión?")) { */
          window.location.href = "http://localhost:3000/login";
        /* } */
      }      
    </script>  
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    
    <style type="text/css">
      .ocultar {
      display: none;
      }
      
      .mostrar {
          display: block;
      }
    </style>


  </head>
  <body>

   <!--  <form action="" method="post">
      <input type="password" name="password" id="password" placeholder="password"  /><br />
      <input type="password" name="confirm-password"  id="confirm-password"  placeholder="confirm-password"  /><br />
      <input type="submit" value="submitx" />
    </form> -->

    <div class="container">

      <section class="mt-5 row">
        <article class="col-sm-12 col-md-9 col-lg-5 mb-5">
          <h1>ecommerce-5i</h1> <br />
          <h3>Restaurar contraseña para:</h3>
          <form action="" method="post" onsubmit="verificarPasswords(); return false">
            <fieldset disabled>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Dirección de email:</label>
                <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="<%= email%>"">
                <div id="emailHelp" class="form-text">Se enviará un mail a esta casilla de correo para restaurar su contraseña.</div>
              </div>
            </fieldset>  

            <div class="mb-3">
              <label for="exampleInputPassword1" class="form-label">Nueva Contraseña</label>
              <input type="password" name="password" class="form-control" id="password" placeholder="Ingrese la nueva contraseña"
              required
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16}">
              <div id="emailHelp" class="form-text">La contraseña debe tener una letra minúscula, una letra mayúscula, un número, un carácter especial y entre 8 y 16 caracteres.</div>
            </div>
  
            <div class="mb-3">
              <label for="exampleInputPassword2" class="form-label">Confirmar Contraseña</label>
              <input type="password" name="confirm-password" id="confirm-password" class="form-control" placeholder="Confirme la nueva contraseña" 
              required 
              pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,16}">
              <div id="emailHelp" class="form-text">La contraseña debe tener una letra minúscula, una letra mayúscula, un número, un carácter especial y entre 8 y 16 caracteres.</div>
            </div>
           
            <button type="submit" class="btn btn-primary"  value="submit">Restaurar</button>
          </form>

          <div id="msg"></div>
 
          <!-- Mensajes de Verificación -->
          <div id="error" class="alert alert-danger ocultar" role="alert">
              Las Contraseñas no coinciden, vuelve a intentar !
          </div>
          <div id="ok" class="alert alert-success ocultar" role="alert">
              Las Contraseñas coinciden ! (Procesando formulario ... )
          </div>
          <!-- Fin Mensajes de Verificación -->


        </article>
      </section>

    </div>

    <script>

      function verificarPasswords() {
      
        // Ontenemos los valores de los campos de contraseñas 
        let pass1 = document.getElementById('password');
        let pass2 = document.getElementById('confirm-password');

        console.log(pass1, pass2, "<<<<<--- PASS " )

        // Verificamos si las constraseñas no coinciden 
        if (pass1.value != pass2.value) {

            // Si las constraseñas no coinciden mostramos un mensaje 
            document.getElementById("error").classList.add("mostrar");

            return false;
        } else {

            // Si las contraseñas coinciden ocultamos el mensaje de error
            document.getElementById("error").classList.remove("mostrar");

            // Mostramos un mensaje mencionando que las Contraseñas coinciden 
            document.getElementById("ok").classList.remove("ocultar");

            // Desabilitamos el botón de login 
            document.getElementById("login").disabled = true; 

           /*  // Refrescamos la página (Simulación de envío del formulario) 
            setTimeout(function() {
                location.reload();
            }, 3000); */

            return true;
        }

      }

    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>   

  </body>
</html>
